---
title: 認証アーキテクチャ
weight: 200
---

モバイルアプリケーションでは通信プロトコルとしてHTTPを使うのが一般的ですが、HTTP自体はステートレスなプロトコルです。そのため初回以降のリクエストをユーザに紐付ける場合、以下の方法のうちのいずれかを使うことになります。

- **ステートフルな認証**
  - ログイン時にユニークなセッションIDをサーバで生成する
  - リクエストとサーバに保存されたユーザ情報を紐付けるために、クライアントは毎回のリクエストにセッションIDを含める
  - セッションIDはただの識別子であり、ユーザ情報は含まない
- [**ステートレスな認証**]({{< relref "./stateless-authn/index.md" >}})
  - ログイン時にユーザ情報を含むトークンを発行する
  - ユーザを識別するための情報はすべてクライアントでトークンとして保存される
  - リクエストとユーザ情報を紐付けるために、クライアントは毎回のリクエストにトークンを含める
  - サーバはトークンの正当性を検証したうえで、リクエストに含まれるトークンからユーザ情報を取得する
  - この場合、サーバはユーザごとの認証状態をセッションなどで管理する必要がない

Webアプリケーションではサーバでランダムに生成されたセッションIDをクライアントのCookieに保存するステートフルな認証を使うのが一般的です。しかしモバイルアプリケーションでは、以下の理由からステートレスな認証を使うケースが多くなってきています。

- セッションをサーバで管理する必要がないため、スケーラビリティとパフォーマンスが向上する
- 認証ロジックをアプリケーションから分離でき、認証サーバでトークンを生成できるので、認証ロジックを簡単に切り替えられる

{{<hint info>}}
参考: [Mobile App Authentication Architectures - Mobile Security Testing Guide](https://mobile-security.gitbook.io/mobile-security-testing-guide/general-mobile-app-testing-guide/0x04e-testing-authentication-and-session-management#stateful-vs-stateless-authentication)
{{</hint >}}
