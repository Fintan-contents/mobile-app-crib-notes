---
title: NablarchのJava規約一覧
---

<!-- textlint-disable -->
<!-- markdownlint-disable -->

> TODO: レビュー用。マージする前に削除する。

### 2.パッケージ構成

アプリケーションのパッケージ構成についての規約です。

| 項   | タイトル                                                                                                                                                                                                    | 内容                                           | SantokuAppの対応               |
|:----|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------|:----------------------------|
| 2.1 | [方式設計上のステレオタイプに従ってパッケージを構成してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no2-1) | 業務アプリケーションでは方式設計上のステレオタイプに従ってパッケージを構成してください。 | 対象（コーディングに関する命名規約のリンク参照にする） |

### 3.命名

クラスやメソッド、変数の命名についての規約です。

| 項   | タイトル                                                                                                                                                                                                                   | 内容                                                                                                         | SantokuAppの対応 |
|:----|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------|:--------------|
| 3.1 | [クラス名は基本的には名詞とし、必要に応じて方式設計上のステレオタイプに従って命名してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no3-1) | クラス名は基本的には名詞にします。慣習的に「特定の能力を付与することを表すインターフェース」は、末尾にableを付ける事があります。Java標準APIにもそのような名前のインターフェースがいくつも含まれています。 | 対象            |
| 3.2 | [メソッド名は基本的には動詞から始まるように命名をしてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no3-2)                 | メソッド名は動詞から始まるように命名をするのが基本になりますが、次に示す「機能別の推奨命名ルール」には動詞から始まらないものも含んでいます。                                     | 対象            |
| 3.3 | [変数は基本的には名詞で命名してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no3-3)                            | フィールド名やローカル変数名は基本的には名詞にします。                                                                                | 対象            |
| 3.4 | [データモデルの用語辞書を活用して命名してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no3-4)                       | 整理された用語辞書をもとにすると、統一感のある命名が出来ます。是非、用語辞書を活用してください。 用語辞書が整理されていない場合は、まず用語辞書の整理をすることを検討してみてください。               | 対象           |

### 4.コメント

Javadocコメントや処理の説明をするためのコメントに関する規約です。

| 項     | タイトル                                                                                                                                                                                                      | 内容                                                           | SantokuAppの対応 |
|:------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------|:--------------|
| 4.1 | [クラスのJavadocコメントを書くようにしてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no4-1)       | クラスのJavadocコメントには、そのクラスの役割を記載してください。プロジェクトのルールに応じて@authorや@sinceなども記載してください。 | 対象外           |
| 4.2 | [フィールドのJavadocコメントを書くようにしてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no4-2)     |  フィールドのJavadocコメントには、それがどのような属性を表すものなのか、記載してください。| 対象外            |
| 4.3 | [メソッドのJavadocコメントを書くようにしてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no4-3)      | メソッドのJavadocには、そのメソッドが行う処理の概要を記載してください。 また、そのメソッドを呼び出す上で前提条件があれば、それも記載してください。@paramで引数の説明を、@returnで戻り値の説明を、@throwsでスローされる可能性がある例外の説明を記載してください。@throwsでは例外クラスの日本語名だけを書いて済ませてはいけません。 該当の例外がスローされるのはどのような場合かを記載してください。| 対象外            |
| 4.4 | [コードの理解を助けるため、必要に応じて行コメントを記載してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no4-4) | コードだけを読んで処理の内容を理解できるのが理想的ですが、複雑なロジックや、パフォーマンスのためにあえて特殊な実装をした場合は説明のコメントを記載してください。 コメントは//から始まる一行コメントの形式で記載してください。| 対象            |

### 5.禁止事項

バグを発生させそうな危ういコードを減らすため、禁止事項を定めています。

| 項    | タイトル                                                                                                                                                                                                                   | 内容                                                                                                                                                                                                                                                                                                                          | SantokuAppの対応                                                                                                                                 |
|:-----|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------|
| 5.1  | [計算式の途中でインクリメント・デクリメントをしないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-1)                 | 計算式の途中でインクリメント・デクリメントをすると、該当の変数の値が分かりにくくなります。計算式は計算式で済ませてしまって、そのあとインクリメント・デクリメントをするようにしてください。                                                                                                                                                                                                                               | 対象                                                                                                                                            |
| 5.2  | [フィールドを一時変数として使用しないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-2)                        | コレクションの要素を順次処理して必要な値を構築するメソッドなどで中間状態を保持するために一時変数を導入することがありますが、その場合にフィールドを使用しないでください。フィールドを使用するとクラスが持つ状態を増やすことになります。 なるべく変更可能な状態は持たないようにするためにも、一時変数の用途でフィールドは使用しないでください。一時変数の用途にはフィールドではなく、ローカル変数を使用してください。                                                                                                                  | 対象                                                                                                                                            |
| 5.3  | [スーパークラスと同名のフィールドをサブクラスで定義しないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-3)              | スーパークラスに定義されているフィールドと同名のフィールドをサブクラスにも定義すると、スーパークラスに定義されているフィールドを名前だけでアクセスできなくなります。フィールドはメソッドと異なりオーバーライドできません。混乱の元となるので、スーパークラスと同名のフィールドをサブクラスで定義しないでください。                                                                                                                                                                   | 対象外（TSC：TS2415: Class 'LoggerSub' incorrectly extends base class 'Logger'.   Types have separate declarations of a private property 'level'.） |
| 5.4  | [戻り値がコレクションや配列の場合は null を返さないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-4)              | 値がない状態を表すためにnullを使うことがありますが、戻り値が次に示すようなコレクションや配列の場合は値がない状態を表すためであってもnullを返さないでください。                                                                                                                                                                                                                                         | 対象                                                                                                                                            |
| 5.5  | [コンストラクタ内で自分自身のインスタンスメソッドを呼び出さないようにしてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-5)       | コンストラクタ内では、たとえfinalが付いているフィールドであっても初期化前のnull値を参照してしまう場合があります。そのため、コンストラクタからフィールドを参照するインスタンスメソッドを呼び出す場合、フィールドの初期化とメソッドの呼び出しの順番に注意する必要が出てきてしまいます。                                                                                                                                                                             | 対象                                                                                                                                            |
| 5.6  | [インスタンスが格納された変数をレシーバにして static メソッドを呼び出さないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-6) | staticメソッドは通常、クラス名をレシーバにして呼び出すコードを書きます。インスタンスが格納された変数をレシーバにして呼び出すコードも文法的には許容されていますが、一般的ではないため行わないでください。                                                                                                                                                                                                                     | 対象外（そもそも利用頻度が低いからなくても良さそう）                                                                                                                    |
| 5.7  | [インスタンスが格納された変数をレシーバにして static 変数を参照しないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-7)    | static変数は通常、クラス名をレシーバにして参照するコードを書きます。インスタンスが格納された変数をレシーバにして参照コードも文法的には許容されていますが、一般的ではないため行わないでください。                                                                                                                                                                                                                         | 対象外 （そもそも利用頻度が低いからなくても良さそう）                                                                                                                   |
| 5.8  | [アプリケーションプログラマーの独断で例外クラスは作らないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-8)              | 例外はメソッドの処理を中断して大域脱出ができる仕組みです。 適切な管理の元、統一的に扱うべきだと考えます。必要な例外クラスはフレームワークが提供するものとし、アプリケーションプログラマーは提供されたクラスを使用してください。もし例外クラスの作成が必要になった場合は、アーキテクトへ相談してください。                                                                                                                                                                       | 対象外                                                                                                                                           |
| 5.9  | [java.lang.Exceptionクラスのインスタンスを生成してスローしないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-9)  | 明示的に例外をスローする場合に単なるjava.lang.Exceptionクラスのインスタンスを生成してスローしないでください。 業務アプリケーションの方式設計に沿った例外クラスのインスタンスを生成してスローしてください。java.lang.Exceptionはすべての例外の基底クラスなので、catchする側が業務アプリケーションの例外なのかネットワークの例外なのかといった判別ができません。また、java.lang.Exceptionをスローするとthrows Exceptionをメソッドに付与しなければいけませんが、呼び出し元のメソッドにもthrows Exceptionを強要することになり、扱いづらくなってしまいます。 | 対象外                                                                                                                                           |
| 5.10 | [try-catch 文を条件分岐のために使用しないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-10)                | try-catch文は例外を扱うためのものです。 条件分岐をしたい場合はif文を使用してください。また例外がスローされた場合、catchできるかどうかをチェックしますが、このチェックは高コストです。 特にループ内でtry-catchを条件分岐のために使用していた場合は、性能劣化が顕著に起る可能性があります。                                                                                                                                                                  | 対象（パフォーマンスに関する説明は違うかも）                                                                                                                        |
| 5.11 | [秘匿情報はログ出力やシリアライズされないように注意してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-11)               | パスワードのような秘匿情報はログに含まれないようにマスクするなど、注意をしてください。また、インスタンスをシリアライズする場合も、秘匿情報が含まれないように注意してください。 なお、ここでは「シリアライズ」という言葉の意味として、JavaのシリアライズのみならずJSONやXMLなどのフォーマットに変換することも含めています。例えばJavaのシリアライズの場合、シリアライズ対象外にしたいフィールドにはtransientキーワードを付与します。                                                                                              | 対象                                                                                                                                            |
| 5.12 | [Java標準ライブラリにあるレガシーなAPIは使用しないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-12)             | Java標準ライブラリには過去のバージョンでは使われていましたが、今となってはレガシーであり使うべきではないAPIがあります。 次に列挙するレガシーAPIは使わないようにしてください。                                                                                                                                                                                                                                | 対象外                                                                                                                                           |
| 5.13 | [リフレクションを直接使用しないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-13)                          | java.lang.reflectパッケージにあるクラスを使ってできる操作をリフレクションと言いますが、リフレクションを直接使用しないでください。 リフレクションを使用すると動的なオブジェクト操作ができますが「コンパイルは通っているけれど、実行時にエラーが出る」といった状況を引き起こす原因になります。フレームワークやアーキテクトから提供される共通部品が内部でリフレクションを使用していることはありますが、アプリケーションで直接使用することは禁止します。リフレクションを使用しているかどうかは使用不許可APIチェックツールによって検出できますが、危険なコードを書かないためにも本規約に明記しています。                | 対象外                                                                                                                                           |
| 5.14 | [クラスを不整合な状態にしないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-14)                           | クラス内に関連性のある複数のフィールドを定義した場合、それらのフィールド間で値の整合性を保つようにしてください。                                                                                                                                                                                                                                                                    | 対象                                                                                                                                            |
| 5.15 | [アプリケーションプログラマーの独断でスレッドを作って非同期処理をしないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-15)      | フレームワークはスレッドに紐付けてデータベースコネクションやトランザクションを管理していることがあります。 アプリケーションプログラマーが自分でスレッドを作って非同期処理を行うことは想定されていません。また、フレームワークの制限が無いとしても非同期処理は高難度です。 パフォーマンスなどの観点から非同期処理が必要になった場合は、アーキテクトに相談してください。                                                                                                                                        | 対象外                                                                                                                                           |
| 5.16 | [名前と値が同じ定数は作らないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no5-16)                           | 定数の名前と値が同じになっているものは、もっと良い名前がある場合と、そもそも定数にしなくて良い場合があります。次に示すのは、もっと良い名前がある例です。 定数名が改行コードの値そのものになっています。                                                                                                                                                                                                                        | 対象                                                                                                                                            |

### 6.注意事項

禁止とまではいきませんが、バグを防いだり保守性を損なわないために、注意事項を定めています。

| 項    | タイトル                                                                                                                                                                                                                             | 内容                                                                                                                                                                                                                                                                                                                            | SantokuAppの対応                |
|:-----|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------|
| 6.1  | [メソッドには名前から想像できない処理を実装しないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-1)                            | メソッド名から想像できない処理が実装されていると、そのメソッドの使用者は混乱します。                                                                                                                                                                                                                                                                                    | 対象                           |
| 6.2  | [単一のメソッドに複数の要素を詰め込まないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-2)                                | 単一のメソッドに「取得」「更新」「チェック」といった複数の要素を詰め込まないでください。 複数の要素を詰め込んだメソッドの名前は、executeやupdateなど抽象的なものになりがちです。アプリケーションのコードは「プレゼンテーション」や「ビジネスロジック」、「データアクセス」といったレイヤーに分かれています。 それぞれのレイヤーによって抽象度は異なるので一概には言えませんが、アプリケーションプログラマーが書くビジネスロジックでは単一のメソッドには複数の要素を詰め込まず具体的な名前を付けるよう努めてください。                                                            | 対象                           |
| 6.3  | [クラス外に公開されるメソッドの引数や戻り値・フィールドの型は実装クラスではなくインターフェースで宣言してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-3) | クラス外に公開されるメソッドの引数や戻り値、フィールドの宣言には実装クラスではなくインターフェースを使用してください。引数を実装クラスで宣言していると、引数の型を変更した場合に呼び出し元のコードも変更しなくてはいけません。                                                                                                                                                                                                               | 対象外                          |
| 6.4  | [メソッドのオーバーロードはオプションの省略用途のみに使用してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-4)                       | 引数の順番が入れ替わっただけのメソッドをオーバーロードしたり、全く異なる型の引数を取るメソッドをオーバーロードするとコードが複雑になります。メソッドのオーバーロードはオプション扱いの引数を省略したメソッドを定義する場合にのみ使用してください。 その際も、引数の順番に注意をして後ろの引数から省略するようにメソッドを設計してください。                                                                                                                                                        | 対象外                          |
| 6.5  | [未使用コードは残したままにしないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-5)                                    | 試行錯誤や性能改善の過程で使用されなくなったメソッドや変数、デバッグ用のコードなどは残したままにせず削除してください。ただし、次のような未使用コードは例外として扱います。 これらは削除せずに残しておいてください。                                                                                                                                                                                                                    | 対象                           |
| 6.6  | [クラスは大きくなりすぎないようにしてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-6)                                   | クラスが大きすぎると内容の把握が難しくなり、保守性が低くなります。 そのような場合は、クラスを分割することを検討してください。フィールドはクラスの状態を表すものですが、中でも変更可能なフィールドが多いとクラス全体の把握が難しくなります。 なるべく変更可能なフィールドを減らすか、分割して別のクラスに移動してください。 ただし次に示すようなデータの入れ物として機能するクラスは、変更可能なフィールドが多くなる傾向にありますが意味のある単位でクラスが作られているので分割しないでください。                                                                            | 対象                           |
| 6.7  | [メソッドは大きくなりすぎないようにしてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-7)                                  | メソッドが大きすぎると処理の把握が難しくなり、保守性が低くなります。 そのような場合は、メソッドを分割することを検討してください。最も簡単なのはある程度の塊ごとにprivateメソッドへ切り出すことです。また、メソッドの引数の個数も多くなりすぎないようにしてください。                                                                                                                                                                                        | 対象                           |
| 6.8  | [インナークラスやstaticにネストしたクラス、匿名クラスは作りすぎないようにしてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-8)            | インナークラスやstaticにネストしたクラス、匿名クラスの使用を特に禁止しませんが、これらのクラスを作りすぎてしまうとコードの可読性が低くなってしまいます。もし大量のインナークラスやstaticにネストしたクラス、匿名クラスが必要な場合は、別の独立したクラスに切り出せないか検討してみてください。                                                                                                                                                                         | 対象外                          |
| 6.9  | [可能な限りキャストは使用しないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-9)                                     | キャストはある型として扱っている値を強制的に異なる型として扱うようにする仕組みで、「コンパイルは通っているけれど、実行時にエラーが出る」といった状況を引き起こす原因になります。Java 5からジェネリクスが導入されて、キャストを使用しなくてもほとんど困る事はなくなっているはずです。                                                                                                                                                                                 | 対象                           |
| 6.10 | [ラッパークラスの変数とプリミティブ値を演算する際は、アンボクシングに注意してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-10)              | java.lang.Integerのようなラッパークラスをintのようなプリミティブ値へ変換することをアンボクシングと言います。ラッパークラスの変数はプリミティブ値を演算する場合、コンパイラーによって自動でアンボクシング処理が差し込まれます。                                                                                                                                                                                                     | 対象外（undefinedかtscでチェック可能なので） |
| 6.11 | [計算の誤差が許されない場合はBigDecimalを使用してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-11)                       | floatとdoubleは浮動小数点数と呼ばれる方法で表現される数値型ですが、浮動小数点数の計算はいくつかのケースで誤差を生じることがあります。GUIの座標計算のように多少の誤差を無視できる場合は浮動小数点数を使用しますが、金利や値引きなどのように誤差が許されない場合はjava.math.BigDecimalを使用してください。                                                                                                                                                         | 対象外                          |
| 6.12 | [ソートと集計はJava側ではなく、SQLで行うようにしてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-12)                        | データベース内のデータのソートや集計はJava側ではなくSQLで行ってください。データが少量であればJava側でソートを行っても問題はありませんが、データが大量だと性能劣化の原因となります。 また、データベースから少量ずつフェッチして処理を行う場合はそもそもJava側でソートができません。集計は通常、大量データに対して行うものですので、これもJava側で行うと性能劣化の原因となります。 それにソートと異なり集計前のデータは一時的に使用するもので、本当に必要なのは最終的な集計結果です。 このことからもSUMやAVRなどの集計関数を使用してSQLで集計してください。                                  | 対象外                          |
| 6.13 | [ループ処理の中では極力データベースアクセスしないようにしてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-13)                       | 業務アプリケーションでは、データベースから取得したデータをループで1件ずつ処理することがよくあります。このとき、ループの中で追加の情報を取得するためにデータベースへアクセスしないようにしてください。 データベースアクセスの回数が多くなり、性能劣化の原因となります。可能な限り、最初のデータ取得時にテーブル結合を使用して1回のデータベースアクセスで必要な情報を取得するようにしてください。                                                                                                                             | 対象外                          |
| 6.14 | [外部からの入力値は共通部品を用いてチェックしてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-14)                             | アプリケーション外部からの入力値にはいくつかの種類があります。 次に3つの例を挙げます。これらの値は必ず入力仕様に沿ってチェックをしてください。 例えばブラウザから送信されたフォームの値であればBean Validationを使用してバリデーションを行ってください。 他のものも同様で、フレームワークが提供している機能を使用して入力値チェックを行ってください。なお「アプリケーション外部からの入力値」というとデータベースから取得したデータも該当しそうですが、自分たちのコントロール下にあるデータベースには既にチェック済みの信頼できる値が格納されているはずです。 このことから、データベースから取得したデータは入力値チェック対象外です。 | 対象                           |
| 6.15 | [ファイル入出力は共通部品のクラスを使用してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-15)                               | アプリケーションプログラマーが思い思いにファイル入出力を実装すると文字コードや改行コードの取り扱いを統一させるのに労力がかかります。アーキテクトはプロジェクトで定めるファイルフォーマット仕様に基づいて、ファイル入出力の共通部品を作成してください。 そしてアプリケーションプログラマーがファイル入出力を実装する際は、共通部品のクラスを使用してください。不足機能は共通部品に追加する方向でアーキテクトへ依頼・相談してください。共通部品を使ってファイル入出力を実装することで、文字コードや改行コードの取り扱いを統一できます。 また、共通部品内で要求されたファイルパスのチェックを行うことでディレクトリトラバーサルを防げます。         | 対象外                         |
| 6.16 | [リソースをクローズする必要がある場合はtry-with-resources構文を使用してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-16)        | java.io.InputStreamやjava.io.OutputStreamなど、外部リソースを使用するオブジェクトはtry-with-resources構文を使用してクローズ漏れが無いようにしてください。try-with-resources構文はJava 7で導入されました。                                                                                                                                                                                 | 対象外                          |
| 6.17 | [例外処理はプロジェクトの方式設計に従って統一的にコーディングしてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-17)                    | 例外処理方式はプロジェクトで統一されていることが重要になります。 プロジェクトの方式設計に従って統一的にコーディングしてください。                                                                                                                                                                                                                                                             | 対象                           |
| 6.18 | [ループのネストはできれば二重までにしてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no6-18)                                 | ループのネストが深くなるとコードの可読性が低下します。 可読性は主観によるものなのでこの指標は絶対ではないですが、本規約ではループのネストは二重までと定めます。                                                                                                                                                                                                                                              | 対象                           |

### 7.推奨事項

より良いコードを書くために、推奨事項を定めています。


| 項    | タイトル                                                                                                                                                                                                                          | 内容                                                                                                                                                                                                                                                                                  | SantokuAppの対応                                                    |
|:-----|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------|
| 7.1  | [クラスやメソッドなどには適切なアクセス修飾子を付与してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no7-1)                       | クラスやメソッドなど、アクセス修飾子を付与できる場所では適切なアクセス修飾子を選択してください。 アクセス修飾子の種類と公開範囲を次に示します。みだりにpublicで宣言せず、必要がなければ狭い範囲になるようアクセス修飾子を付与してください。                                                                                                                                                           | 対象                                                               |
| 7.2  | [インスタンス変数は原則 private にしてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no7-2)                           | インスタンス変数はクラス外に露出するべきではありません。 原則privateとしてください。例外的に、フレームワークの制約でprivate以外にしなくてはならない場合は適切なアクセス修飾子を付与してください。また、抽象クラスを作成してサブクラスで参照させたいインスタンス変数がある場合はprotectedにしてください。 ただし、その場合でもみだりにインスタンス変数を公開するのではなく、メソッドを併用することでインスタンス変数をprivateにできないか検討してください。                                       | 対象                                                               |
| 7.3  | [ローカル変数はできるだけ狭いスコープで使用してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no7-3)                           | ローカル変数のスコープができるだけ狭くなるように利用する場所と近い位置で宣言をしてください。                                                                                                                                                                                                                                      | 対象                                                               |
| 7.4  | [なるべく再代入は避けて、そのためにfinalを活用してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no7-4)                       | コードは「変更可能な状態」が少なければ少ないほど、全体の把握がしやすく理解しやすい傾向にあります。変数を再代入するということは、知らないうちに「変更可能な状態」を作っていることになります。                                                                                                                                                                                      | 対象                                                               |
| 7.5  | [なるべく引数の状態を変えないでください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no7-5)                                   | コードは「状態を変更する箇所」が局所的であればあるほど、全体の把握がしやすく理解しやすい傾向にあります。引数の状態を変更してしまうと、状態を変更する箇所が広がってしまうことになります。                                                                                                                                                                                        | 対象                                                               |
| 7.6  | [戻り値として null を使いたい場合、Optional の使用を検討してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no7-6)             | 値が「無い」状態を表す手段としてnullを使う方法と、Java 8から導入されたjava.util.Optionalを使う方法があります。戻り値をjava.util.Optionalにすると、値を返さない場合があるメソッドだということをシグネチャで表現できます。                                                                                                                                                 | 対象外                                                              |
| 7.7  | [コレクションのように型パラメーターを取るクラスを使用する場合は適切な型をバインドしてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no7-7)        | java.util.Listやjava.util.Mapのようなコレクションやjava.util.Optionalは、型パラメーターが定義されています。 このようなクラスを使用する場合は適切な型をバインドしてください。適切な型をバインドすることでコンパイラーによる型チェックを活かせます。                                                                                                                                    | 対象外                                                              |
| 7.8  | [コレクションの処理はStream APIを使用して簡潔に書くことを検討してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no7-8)             | Java 8から導入されたStream APIを使用すればjava.util.Listやjava.util.Setなどのコレクションを簡潔なコードで処理できる場合があります。Stream APIはfilterやmap、collectといったメソッドを使用して各要素に対する操作を小さく設定できます。 そのため、各要素に対してどのような処理をするのかが分かりやすくなる傾向にあります。                                                                                     | 対象（forよりCollectoinAPIは使いましょう）                                    |
| 7.9  | [チェック例外のスローを伴う処理はStream APIではなく拡張for文を使用して実装してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no7-9)     | Stream APIはコレクションの操作を簡潔に書けますが、チェック例外のスローが宣言されているメソッドを呼び出す場合はラムダ式の中でtry-catchを書かなくてはいけません。せっかく簡潔に書けるはずのStream APIがtry-catchによって煩雑なコードになってしまいます。 そのため、チェック例外のスローを伴う操作が含まれる場合は拡張for文を使用してください。ファイルの入出力では多くの場合にjava.io.IOExceptionがスローされます。 コレクション操作に伴ってファイルを処理する場合は拡張for文を使用すると良いでしょう。 | 対象外                                                              |
| 7.10 | [レガシーfor文はなるべく使用せず、Stream APIか拡張for文の使用を検討してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no7-10)      | コレクションの要素を順次処理するにはStream APIと拡張for文が使えるので、レガシーfor文を使用する場面は通常ありません。 レガシーfor文はなるべく使用しないようにしてください。                                                                                                                                                                                     | ESLintでNGにする（https://qiita.com/putan/items/0c0037ce00d21854a8d0） |
| 7.11 | [配列全体をコピーする場合はcloneメソッドを使用してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no7-11)                      | 配列全体をコピーする場合はcloneメソッドを使用するのが最もシンプルです。                                                                                                                                                                                                                                              | 対象（シャローコピーで良いときはスプレット構文を追加ましょう。Objectも同様）                        |
| 7.12 | [コレクションを配列に変換する場合はtoArrayメソッドを使用してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no7-12)                | コレクションには配列に変換するtoArrayメソッドが用意されています。 各要素をループして配列を作ったりせず、toArrayメソッドを使用してください。                                                                                                                                                                                                       | 対象外                                                              |
| 7.13 | [配列をコレクションに変換する場合はArrays.asList、またはList.ofを使用してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no7-13)   | 配列のユーティリティであるjava.util.Arraysクラスにはリストに変換するasListメソッドが用意されています。 各要素をループしてリストを作ったりせず、java.util.ArraysクラスのasListメソッドを使用してください。                                                                                                                                                         | 対象外                                                              |
| 7.14 | [メソッドをオーバーライドしたり、抽象メソッドを実装する場合はメソッドに@Overrideを付けてください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no7-14) | サブクラスでスーパークラスのメソッドをオーバーライドする場合、サブクラス側のメソッドに@Overrideを付けてください。 @Overrideを付けておくと、コンパイラーが本当にオーバーライドされたメソッドであるかチェックしてくれます。                                                                                                                                                              | 対象外                                                              |

### 8.使用可能なAPI

業務アプリケーションを開発するのに十分なだけのAPIを厳選することで、品質を確保するための規約です。

| 項     | タイトル                                                                                                                                                                                            | 内容                                                           | SantokuAppの対応 |
|:------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------|:--------------|
| 8.1| [使用可能な標準APIを使用して実装してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no8-1) | Java標準ライブラリのうち使用可能なAPIについては、Java標準ライブラリ使用可能APIを参照してください。また、使用不許可APIチェックツールを使用してチェックを行えますので活用してください。| 対象外           |

### 9.Nablarchライブラリ

Nablarchではアプリケーションプログラマー向けに公開するAPIを厳選しています。 それらのAPIに絞って開発することで、品質を確保するための規約です。

| 項   | タイトル                                                                                                                                                                                                   | 内容                                                                                                                                                                   | SantokuAppの対応 |
|:----|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------|
| 9.1 | [使用可能なNablarchのAPIを使用して実装してください](https://github.com/Fintan-contents/nablarch-system-development-guide/blob/master/サンプルプロジェクト/サンプルプロジェクト開発ガイド/PGUT工程/proman-style-guide/java/java-style-guide.md#no9-1) | Nablarchのライブラリのうち使用可能なAPIについては、アプリケーションプログラマー向けのJavadocを参照してください。業務要件上Javadocに記載のないAPIを使用する必要がある場合は、アーキテクトへ相談するようにしてください。また、使用不許可APIチェックツールを使用してチェックを行えますので活用してください。 | 対象外           |
