---
title: 登録トークンの削除
---

ログアウト時に登録トークンを削除します。

## 処理フロー

処理フローは以下になります。

![登録トークンの削除の処理フロー](remove-token.drawio.png)

| No | 処理 | 内容 |
|:--|:--|:--|
| ① | 現在の登録トークンを取得 | 現在の登録トークンを取得します。 |
| ② | 登録トークンの削除 | 登録トークンを削除します。①で取得した登録トークンを指定して登録トークン削除APIを呼び出します。 |

## エラー発生時の処理

バックエンドサーバとの通信エラーなどの理由により登録トークンの削除に失敗した場合、バックエンドサーバに登録トークンが残るのでプッシュ通知が有効なままとなります。
この状態でログアウト処理を続行させた場合、ログアウト済みの端末に通知が届くことになります。
一方で、登録トークンの削除がログアウトの条件となると、オフラインでのログアウトができません。
どちらをとってもメリット・デメリットが生じます。
このアプリでは、登録トークンの削除に失敗した場合はログアウト処理全体を失敗させ、ユーザにリトライを促す仕様とします。
