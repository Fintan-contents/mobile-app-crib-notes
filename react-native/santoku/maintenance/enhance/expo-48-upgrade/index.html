<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-react-native/santoku/maintenance/enhance/expo-48-upgrade">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Expo SDK 48アップグレード | Fintan » Mobile App Development</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://fintan-contents.github.io/mobile-app-crib-notes/react-native/santoku/maintenance/enhance/expo-48-upgrade"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Expo SDK 48アップグレード | Fintan » Mobile App Development"><meta data-rh="true" name="description" content="以下の記事を参考にして、このアプリのExpo SDKを48にアップグレードしました。"><meta data-rh="true" property="og:description" content="以下の記事を参考にして、このアプリのExpo SDKを48にアップグレードしました。"><link data-rh="true" rel="icon" href="/mobile-app-crib-notes/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://fintan-contents.github.io/mobile-app-crib-notes/react-native/santoku/maintenance/enhance/expo-48-upgrade"><link data-rh="true" rel="alternate" href="https://fintan-contents.github.io/mobile-app-crib-notes/react-native/santoku/maintenance/enhance/expo-48-upgrade" hreflang="ja"><link data-rh="true" rel="alternate" href="https://fintan-contents.github.io/mobile-app-crib-notes/react-native/santoku/maintenance/enhance/expo-48-upgrade" hreflang="x-default"><script src="https://plausible.io/js/script.js" defer="defer" data-domain="fintan-contents.github.io,all.fintan"></script><link rel="stylesheet" href="/mobile-app-crib-notes/assets/css/styles.21ba9c31.css">
<link rel="preload" href="/mobile-app-crib-notes/assets/js/runtime~main.ad6d8a75.js" as="script">
<link rel="preload" href="/mobile-app-crib-notes/assets/js/main.ab2052db.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="メインコンテンツまでスキップ"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">メインコンテンツまでスキップ</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://fintan.jp" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/mobile-app-crib-notes/img/fintan-logo.jpg" alt="Fintan Mobile App" class="themedImage_ToTc themedImage--light_HNdA"><img src="/mobile-app-crib-notes/img/fintan-logo.jpg" alt="Fintan Mobile App" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a class="navbar__item navbar__link" href="/mobile-app-crib-notes/">Home</a><a class="navbar__item navbar__link" href="/mobile-app-crib-notes/reference">Reference</a><a class="navbar__item navbar__link" href="/mobile-app-crib-notes/distribution">Distribution</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">React Native</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/mobile-app-crib-notes/react-native/learn">Learn</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/mobile-app-crib-notes/react-native/santoku">Example App</a></li><li><a class="dropdown__link" href="/mobile-app-crib-notes/react-native/common-pitfalls">Pitfalls</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/fintan-contents/mobile-app-crib-notes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="先頭へ戻る" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a href="https://fintan.jp" target="_blank" rel="noopener noreferrer" tabindex="-1" class="sidebarLogo_isFc"><img src="/mobile-app-crib-notes/img/fintan-logo.jpg" alt="Fintan Mobile App" class="themedImage_ToTc themedImage--light_HNdA"><img src="/mobile-app-crib-notes/img/fintan-logo.jpg" alt="Fintan Mobile App" class="themedImage_ToTc themedImage--dark_i4oU"></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mobile-app-crib-notes/react-native/santoku">はじめに</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/mobile-app-crib-notes/react-native/santoku/requirements">Requirements</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/mobile-app-crib-notes/react-native/santoku/application-architecture">Application Architecture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/mobile-app-crib-notes/react-native/santoku/test-planning">Test Planning</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/mobile-app-crib-notes/react-native/santoku/design">Design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/mobile-app-crib-notes/react-native/santoku/development">Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/mobile-app-crib-notes/react-native/santoku/maintenance">Maintenance</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mobile-app-crib-notes/react-native/santoku/maintenance">目次</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/mobile-app-crib-notes/react-native/santoku/maintenance/enhance">エンハンス</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mobile-app-crib-notes/react-native/santoku/maintenance/enhance">概要</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mobile-app-crib-notes/react-native/santoku/maintenance/enhance/expo-49-upgrade">Expo SDK 49アップグレード</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/mobile-app-crib-notes/react-native/santoku/maintenance/enhance/expo-48-upgrade">Expo SDK 48アップグレード</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mobile-app-crib-notes/react-native/santoku/maintenance/enhance/expo-47-upgrade">Expo SDK 47アップグレード</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mobile-app-crib-notes/react-native/santoku/maintenance/enhance/config-plugins">Config Plugins対応</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mobile-app-crib-notes/react-native/santoku/maintenance/enhance/expo-46-upgrade">Expo SDK 46アップグレード</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/mobile-app-crib-notes/react-native/santoku/decisions">Decision Records</a></div></li></ul></nav><button type="button" title="サイドバーを隠す" aria-label="サイドバーを隠す" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">このページの見出し</button></div><div class="theme-doc-markdown markdown"><header><h1>Expo SDK 48アップグレード</h1></header><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>参考</div><div class="admonitionContent_S0QG"><p>以下の記事を参考にして、このアプリのExpo SDKを48にアップグレードしました。
主な変更点とこのアプリで実施したアップグレード手順を紹介します。</p><ul><li><a href="https://blog.expo.dev/expo-sdk-48-ccb8302e231" target="_blank" rel="noopener noreferrer">Expo SDK 48</a></li><li><a href="https://reactnative.dev/blog/2023/01/12/version-071" target="_blank" rel="noopener noreferrer">React Native 0.71: TypeScript by Default, Flexbox Gap, and more...</a></li></ul><p>なお、このアプリでは使用していないため、EASやClassic Updatesに関する内容は記載しません。</p></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expo-sdk-48の主な変更">Expo SDK 48の主な変更<a href="#expo-sdk-48の主な変更" class="hash-link" aria-label="Expo SDK 48の主な変更 への直接リンク" title="Expo SDK 48の主な変更 への直接リンク">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="react-native-0716-and-react-1820">React Native 0.71.6 and React 18.2.0<a href="#react-native-0716-and-react-1820" class="hash-link" aria-label="React Native 0.71.6 and React 18.2.0 への直接リンク" title="React Native 0.71.6 and React 18.2.0 への直接リンク">​</a></h3><p>React NativeのレイアウトエンジンがFlexboxプロパティの<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/gap" target="_blank" rel="noopener noreferrer">gap</a>、<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/row-gap" target="_blank" rel="noopener noreferrer">rowGap</a>、<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/column-gap" target="_blank" rel="noopener noreferrer">columnGap</a>をサポートするようになりました（詳細は<a href="https://reactnative.dev/blog/2023/01/12/version-071#simplifying-layouts-with-flexbox-gap" target="_blank" rel="noopener noreferrer">こちら</a>）。
その他、アクセシビリティやスタイル、イベントに関してWebにインスパイアされたプロパティも追加されています（詳細は<a href="https://reactnative.dev/blog/2023/01/12/version-071#web-inspired-props-for-accessibility-styles-and-events" target="_blank" rel="noopener noreferrer">こちら</a>）。</p><p>Hermesは<code>JSON.parse</code>のパフォーマンスが改善されました。</p><p>TypeScriptを使用している場合は、<code>react-native</code>に型定義が含まれるようになったため、<code>@types/react-native</code>を削除する必要があります。</p><p>詳細は、以下のリンク先を参照してください。</p><ul><li><a href="https://reactnative.dev/blog/2023/01/12/version-071" target="_blank" rel="noopener noreferrer">React Native 0.71: TypeScript by Default, Flexbox Gap, and more...</a></li><li><a href="https://github.com/facebook/react-native/blob/main/CHANGELOG.md#v0716" target="_blank" rel="noopener noreferrer">React Native CHANGELOG</a></li><li><a href="https://github.com/facebook/react/blob/main/CHANGELOG.md#1820-june-14-2022" target="_blank" rel="noopener noreferrer">React CHANGELOG</a></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="javascriptのデフォルトエンジンをhermesに変更">JavaScriptのデフォルトエンジンをHermesに変更<a href="#javascriptのデフォルトエンジンをhermesに変更" class="hash-link" aria-label="JavaScriptのデフォルトエンジンをHermesに変更 への直接リンク" title="JavaScriptのデフォルトエンジンをHermesに変更 への直接リンク">​</a></h3><p>HermesがJavaScriptのデフォルトエンジンになりました。</p><p>Hermesでは、アプリ起動後にユーザがアプリを使用できるまでの時間（TTI: Time to Interactive）が短縮されます。メモリ使用量も削減されるなど、パフォーマンの大きな改善が期待できます。</p><p>また、デバッグ機能もJavaScriptCore（JSC）に比べると大幅に改善されています。</p><p>詳細は、<a href="https://reactnative.dev/blog/2022/07/08/hermes-as-the-default" target="_blank" rel="noopener noreferrer">Hermes as the Default</a>を参照してください。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="全てのexpoモジュールでapiレベルに33を設定">全てのExpoモジュールでAPIレベルに33を設定<a href="#全てのexpoモジュールでapiレベルに33を設定" class="hash-link" aria-label="全てのExpoモジュールでAPIレベルに33を設定 への直接リンク" title="全てのExpoモジュールでAPIレベルに33を設定 への直接リンク">​</a></h3><p>Androidの<code>compileSdkVersion</code>と<code>targetSdkVersion</code>は、すべてのExpoモジュールでAPIレベル33に設定されました。</p><p>これは、2023/08/31以降に適用される（2023/11/01まで期限延長をリクエスト可能）<a href="https://support.google.com/googleplay/android-developer/answer/11926878" target="_blank" rel="noopener noreferrer">Google Playアプリの対象APIレベル要件</a>を満たしています。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expo-goでrtl言語のサポート">Expo GoでRTL言語のサポート<a href="#expo-goでrtl言語のサポート" class="hash-link" aria-label="Expo GoでRTL言語のサポート への直接リンク" title="Expo GoでRTL言語のサポート への直接リンク">​</a></h3><p>Expo GoでRTL言語がサポートされました。<code>app.json</code>や<code>app.config.js</code>で有効化する方法は、<a href="https://docs.expo.dev/guides/localization/#enabling-rtl-support" target="_blank" rel="noopener noreferrer">Enabling RTL Support</a>を参照してください。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="new-architecturefabricのサポート">New Architecture/Fabricのサポート<a href="#new-architecturefabricのサポート" class="hash-link" aria-label="New Architecture/Fabricのサポート への直接リンク" title="New Architecture/Fabricのサポート への直接リンク">​</a></h3><p><code>expo-dev-client</code>を除く全てのExpoモジュールで、New Architecture/Fabricがサポートされました。</p><p>ただし、New Architectureをサポートしていないサードパーティのモジュールが多いため、New Architectureの有効化はまだ推奨されていないようです。
また、Expo GoはNew Architectureをサポートしていません。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expoがサポートするライブラリや機能">Expoがサポートするライブラリや機能<a href="#expoがサポートするライブラリや機能" class="hash-link" aria-label="Expoがサポートするライブラリや機能 への直接リンク" title="Expoがサポートするライブラリや機能 への直接リンク">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ライブラリの更新">ライブラリの更新<a href="#ライブラリの更新" class="hash-link" aria-label="ライブラリの更新 への直接リンク" title="ライブラリの更新 への直接リンク">​</a></h4><p>Expoが管理しているライブラリの内、メジャーバージョンアップなど大きなリリースがあったものを記載します。</p><ul><li><a href="https://docs.expo.dev/versions/v48.0.0/sdk/image/" target="_blank" rel="noopener noreferrer">Expo Image v1.0</a><ul><li>React Nativeの<a href="https://reactnative.dev/docs/image" target="_blank" rel="noopener noreferrer">Image</a>コンポーネントの後継として、または<a href="https://github.com/DylanVann/react-native-fast-image" target="_blank" rel="noopener noreferrer">react-native-fast-image</a>の代替を意図して作成されたライブラリ</li><li><a href="https://docs.expo.dev/versions/v48.0.0/sdk/image/#supported-image-formats" target="_blank" rel="noopener noreferrer">モダンな画像フォーマット</a>をサポート</li><li>スピードが重視された設計</li><li><a href="https://docs.expo.dev/versions/v48.0.0/sdk/image/#placeholder" target="_blank" rel="noopener noreferrer">placeholders</a>や<a href="https://docs.expo.dev/versions/v48.0.0/sdk/image/#transition" target="_blank" rel="noopener noreferrer">transitions</a>、<a href="https://docs.expo.dev/versions/v48.0.0/sdk/image/#imagesource" target="_blank" rel="noopener noreferrer">blurhash</a>など、既存のライブラリでは追加実装を必要とする場合があった機能などもサポート</li></ul></li><li><a href="https://expo.github.io/router/docs/" target="_blank" rel="noopener noreferrer">Expo Router v1.0</a><ul><li>ファイルシステムベースでルーティング可能なナビゲーションライブラリ</li></ul></li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="非推奨となるライブラリ">非推奨となるライブラリ<a href="#非推奨となるライブラリ" class="hash-link" aria-label="非推奨となるライブラリ への直接リンク" title="非推奨となるライブラリ への直接リンク">​</a></h4><p>以下のライブラリが非推奨となりました。</p><ul><li><a href="https://docs.expo.dev/versions/v48.0.0/sdk/random/" target="_blank" rel="noopener noreferrer">expo-random</a><ul><li>expo-randomは、<a href="https://docs.expo.dev/versions/v48.0.0/sdk/crypto/" target="_blank" rel="noopener noreferrer">expo-crypto</a>に統合されました</li></ul></li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expo-module-apiの改善">Expo Module APIの改善<a href="#expo-module-apiの改善" class="hash-link" aria-label="Expo Module APIの改善 への直接リンク" title="Expo Module APIの改善 への直接リンク">​</a></h4><p><code>async</code>/<code>await</code>関数で、Swift Concurrencyがサポートされました。</p><p>また、<code>TypedArray</code>のサポートも進められており、<code>expo-crypto</code>の<code>getRandomValues</code>や<code>digest</code>で使用されています。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="appjsonの非推奨となっていた項目の削除"><code>app.json</code>の非推奨となっていた項目の削除<a href="#appjsonの非推奨となっていた項目の削除" class="hash-link" aria-label="appjsonの非推奨となっていた項目の削除 への直接リンク" title="appjsonの非推奨となっていた項目の削除 への直接リンク">​</a></h4><p><code>entryPoint</code>が<code>app.json</code>から削除されました。代わりに、<code>package.json</code>の<a href="https://docs.npmjs.com/cli/v9/configuring-npm/package-json#main" target="_blank" rel="noopener noreferrer">main</a>を使用してください。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expo-auth-session">expo-auth-session<a href="#expo-auth-session" class="hash-link" aria-label="expo-auth-session への直接リンク" title="expo-auth-session への直接リンク">​</a></h4><p><a href="https://docs.expo.dev/versions/v48.0.0/sdk/auth-session/" target="_blank" rel="noopener noreferrer">expo-auth-session</a>の<code>useProxy</code>が非推奨になりました。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expo-keep-awake">expo-keep-awake<a href="#expo-keep-awake" class="hash-link" aria-label="expo-keep-awake への直接リンク" title="expo-keep-awake への直接リンク">​</a></h4><p><a href="https://docs.expo.dev/versions/v48.0.0/sdk/keep-awake/" target="_blank" rel="noopener noreferrer">expo-keep-awake</a>の<code>activateKeepAwake</code>が非推奨になりました。代わりに、<code>activateKeepAwakeAsync</code>を使用してください。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="react-native-communitydatetimepicker">@react-native-community/datetimepicker<a href="#react-native-communitydatetimepicker" class="hash-link" aria-label="@react-native-community/datetimepicker への直接リンク" title="@react-native-community/datetimepicker への直接リンク">​</a></h4><p><a href="https://github.com/react-native-datetimepicker/datetimepicker/tree/v6.7.3" target="_blank" rel="noopener noreferrer">@react-native-community/datetimepicker</a>の以下の項目が非推奨になりました。</p><ul><li>positiveButtonLabel</li><li>negativeButtonLabel</li><li>neutralButtonLabel</li></ul><p>代わりに、以下の項目が追加されています。</p><ul><li>positiveButton</li><li>negativeButton</li><li>neutralButton</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expo-sdk-45のサポート終了">Expo SDK 45のサポート終了<a href="#expo-sdk-45のサポート終了" class="hash-link" aria-label="Expo SDK 45のサポート終了 への直接リンク" title="Expo SDK 45のサポート終了 への直接リンク">​</a></h3><p>Expo SDK 45がサポート対象外になりました。Expo SDK 45を使用している場合は、Expo SDK 46以降にアップグレードする必要があります。</p><p>なお、次のリリースではExpo SDK46と47のサポートが終了する見込みのようです。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="このアプリで実施したアップグレードの手順">このアプリで実施したアップグレードの手順<a href="#このアプリで実施したアップグレードの手順" class="hash-link" aria-label="このアプリで実施したアップグレードの手順 への直接リンク" title="このアプリで実施したアップグレードの手順 への直接リンク">​</a></h2><p>このアプリでは、以下の作業を上から順に実施してExpo SDK 48にアップグレードしました。</p><ul><li><code>npm install expo@^48.0.0</code>を実行して、Expo SDKをアップグレード</li><li><code>npx expo install --fix</code>を実行して、Expoが管理するライブラリのアップグレード</li><li><a href="#expoconfig-plugins%E3%82%92devdependencies%E3%81%AB%E8%BF%BD%E5%8A%A0"><code>@expo/config-plugins</code>を<code>devDependencies</code>に追加</a></li><li><a href="#jest-expo%E3%81%AE%E3%82%A2%E3%83%83%E3%83%97%E3%82%B0%E3%83%AC%E3%83%BC%E3%83%89"><code>jest-expo</code>のアップグレード</a></li><li><a href="#%E6%97%A2%E5%AD%98%E3%81%AE%E3%83%91%E3%83%83%E3%83%81%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E6%9B%B4%E6%96%B0">既存のパッチファイルの更新</a></li><li><a href="#expo%E3%81%8C%E7%AE%A1%E7%90%86%E3%81%99%E3%82%8B%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%AB%E4%BE%9D%E5%AD%98%E3%81%99%E3%82%8B%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%AE%E6%9B%B4%E6%96%B0">Expoが管理するライブラリに依存するライブラリの更新</a></li><li><code>node_modules</code>、<code>package-lock.json</code>を削除して、<code>npm i</code>を実行</li><li><a href="#expo%E3%81%AE%E6%9B%B4%E6%96%B0%E5%B1%A5%E6%AD%B4%E3%81%AE%E7%A2%BA%E8%AA%8D%E3%81%A8%E5%AF%BE%E5%BF%9C">Expoの更新履歴の確認と対応</a><ul><li><a href="#expo-random%E3%81%8B%E3%82%89expo-crypto%E3%81%B8%E3%81%AE%E7%A7%BB%E8%A1%8C"><code>expo-random</code>から<code>expo-crypto</code>への移行</a></li><li><a href="#expo-keep-awake%E3%81%AEactivatekeepawake%E3%81%8C%E9%9D%9E%E6%8E%A8%E5%A5%A8%E3%81%AB%E3%81%AA%E3%81%A3%E3%81%9F%E3%81%93%E3%81%A8%E3%81%B8%E3%81%AE%E5%AF%BE%E5%BF%9C"><code>expo-keep-awake</code>の<code>activateKeepAwake</code>が非推奨になったことへの対応</a></li><li><a href="#react-native-communitydatetimepicker%E3%81%AE%E4%B8%80%E9%83%A8%E3%81%AE%E9%A0%85%E7%9B%AE%E3%81%8C%E9%9D%9E%E6%8E%A8%E5%A5%A8%E3%81%AB%E3%81%AA%E3%81%A3%E3%81%9F%E3%81%93%E3%81%A8%E3%81%B8%E3%81%AE%E5%AF%BE%E5%BF%9C"><code>@react-native-community/datetimepicker</code>の一部の項目が非推奨になったことへの対応</a></li></ul></li><li><a href="#react-native%E3%81%AE%E6%9B%B4%E6%96%B0%E5%B1%A5%E6%AD%B4%E3%81%AE%E7%A2%BA%E8%AA%8D%E3%81%A8%E5%AF%BE%E5%BF%9C">React Nativeの更新履歴の確認と対応</a><ul><li><a href="#typesreact-native%E3%82%92%E4%BE%9D%E5%AD%98%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%8B%E3%82%89%E5%89%8A%E9%99%A4"><code>@types/react-native</code>を依存ライブラリから削除</a></li></ul></li><li><a href="#expo-template-blank-typescript%E3%81%AE%E6%9B%B4%E6%96%B0%E5%B1%A5%E6%AD%B4%E3%81%AE%E7%A2%BA%E8%AA%8D%E3%81%A8%E5%AF%BE%E5%BF%9C">expo-template-blank-typescriptの更新履歴の確認と対応</a></li><li><a href="#expo-template-bare-minimum%E3%81%AE%E6%9B%B4%E6%96%B0%E5%B1%A5%E6%AD%B4%E3%81%AE%E7%A2%BA%E8%AA%8D%E3%81%A8%E5%AF%BE%E5%BF%9C">expo-template-bare-minimumの更新履歴の確認と対応</a><ul><li><a href="#buckconfig%E3%81%AE%E5%89%8A%E9%99%A4%E3%81%A8gitignore%E3%81%AE%E6%9B%B4%E6%96%B0"><code>.buckconfig</code>の削除と<code>.gitignore</code>の更新</a></li></ul></li><li><a href="https://react-native-community.github.io/upgrade-helper/?from=0.69.6&amp;to=0.70.8" target="_blank" rel="noopener noreferrer">React Native Upgrade Helper</a>を参照して、React Nativeの更新を確認<ul><li>このアプリで必要な対応は、<a href="https://github.com/expo/expo/commits/sdk-48/templates/expo-template-bare-minimum" target="_blank" rel="noopener noreferrer">expo-template-bare-minimumの更新</a>で対応されていました</li></ul></li><li><a href="#javascript%E3%81%AE%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3%E3%82%92hermes%E3%81%AB%E5%A4%89%E6%9B%B4">JavaScriptのエンジンをHermesに変更</a></li><li><code>npm run prebuild</code>を実行してネイティブプロジェクトの再生成</li><li><a href="#flatlist%E3%81%A7%E3%83%87%E3%83%BC%E3%82%BF%E3%81%8C0%E4%BB%B6%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%ABscrolltoend%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B%E3%81%A8%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%8C%E7%99%BA%E7%94%9F%E3%81%99%E3%82%8B%E5%95%8F%E9%A1%8C%E3%81%AE%E5%AF%BE%E5%BF%9C"><code>FlatList</code>でデータが0件の場合に<code>scrollToEnd</code>を実行するとエラーが発生する問題の対応</a></li><li><a href="#jest%E3%81%AE%E3%82%A2%E3%83%83%E3%83%97%E3%82%B0%E3%83%AC%E3%83%BC%E3%83%89%E5%AF%BE%E5%BF%9C">Jestのアップグレード対応</a><ul><li><a href="#jest__mocks__%E9%85%8D%E4%B8%8B%E3%81%AE%E3%83%A2%E3%83%83%E3%82%AF%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%A7%E5%AE%9F%E6%96%BD%E3%81%97%E3%81%A6%E3%81%84%E3%82%8Bbeforeeach%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC"><code>jest/__mocks__</code>配下のモックファイルで実施している<code>beforeEach</code>でエラー</a></li><li><a href="#react-native-communitynetinfo%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC"><code>@react-native-community/netinfo</code>を使用しているコンポーネントのテストでエラー</a></li><li><a href="#done%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E3%83%86%E3%82%B9%E3%83%88%E3%81%AF%E9%9D%9E%E5%90%8C%E6%9C%9F%E9%96%A2%E6%95%B0%E3%81%AB%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84">doneコールバックを使用しているテストは非同期関数にできない</a></li><li><a href="#fake-timers%E3%81%AE%E3%83%87%E3%83%95%E3%82%A9%E3%83%AB%E3%83%88%E3%81%8Cmodern%E3%81%AB%E5%A4%89%E6%9B%B4">Fake Timersのデフォルトが<code>modern</code>に変更</a></li><li><a href="#jest%E5%AE%9F%E8%A1%8C%E6%99%82%E3%81%AE%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E5%A4%89%E6%9B%B4">Jest実行時のオプションの変更</a></li></ul></li><li><a href="#npm-run-android%E3%81%A7%E3%82%A2%E3%83%97%E3%83%AA%E3%81%8C%E8%B5%B7%E5%8B%95%E3%81%97%E3%81%AA%E3%81%84%E5%95%8F%E9%A1%8C%E3%81%AE%E5%AF%BE%E5%BF%9C"><code>npm run android</code>でアプリが起動しない問題の対応</a></li><li><a href="#%E6%89%8B%E5%8B%95%E7%AE%A1%E7%90%86%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E3%81%AE%E6%9B%B4%E6%96%B0">手動管理しているライセンスの更新</a><ul><li><a href="#managed-licensejs%E3%81%AE%E6%9B%B4%E6%96%B0">managed-license.jsの更新</a></li><li><a href="#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E3%81%AE%E8%A1%A8%E8%A8%98%E3%82%86%E3%82%8C%E3%81%AB%E5%AF%BE%E5%BF%9C">ライセンスの表記ゆれに対応</a></li></ul></li></ul><p>アップグレードを実施したPull Requestは<a href="https://github.com/ws-4020/mobile-app-crib-notes/pull/1118" target="_blank" rel="noopener noreferrer">こちら</a>です。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expoconfig-pluginsをdevdependenciesに追加"><code>@expo/config-plugins</code>を<code>devDependencies</code>に追加<a href="#expoconfig-pluginsをdevdependenciesに追加" class="hash-link" aria-label="expoconfig-pluginsをdevdependenciesに追加 への直接リンク" title="expoconfig-pluginsをdevdependenciesに追加 への直接リンク">​</a></h3><p>このアプリの依存ライブラリである<code>expo</code>や<code>@react-native-firebase/app</code>などは、<code>@expo/config-plugins</code>を<code>dependencies</code>に設定しています。
これらのライブラリが設定している<code>@expo/config-plugins</code>のバージョンは様々です。</p><ul><li><code>expo</code>: <code>6.0.1</code></li><li><code>@react-native-firebase/app</code>: <code>^5.0.4</code></li></ul><p>複数のバージョンが混在している場合、<code>deduped</code>が発生し<code>node_modules</code>配下は以下のようになります（必要な箇所以外は省略しています）。</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">node_modules/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── @expo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── cli</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   │   ├── node_modules</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   │   │   ├── @expo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   │   │   │   ├── config-plugins(6.0.1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── config-plugins(5.0.4)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── @react-native-firebase</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── app</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>このアプリでは、<code>@expo/cli</code>が使用する<code>@expo/config-plugins</code>に以下のパッチを適用しますが、<code>deduped</code>が発生するかどうかによってパッチを適用するべきパスが変わってしまいます。</p><ul><li><a href="https://github.com/fintan-contents/mobile-app-crib-notes/blob/v2023.03/example-app/SantokuApp/patches/README.md#expo-config-plugins%E3%81%A7ios%E7%94%A8%E3%81%AB%E8%BF%BD%E5%8A%A0%E3%81%97%E3%81%9F%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AEid%E3%82%92%E5%8F%96%E5%BE%97%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E5%95%8F%E9%A1%8C%E3%81%AB%E5%AF%BE%E5%87%A6%E3%81%99%E3%82%8B%E3%83%91%E3%83%83%E3%83%81" target="_blank" rel="noopener noreferrer">Expo Config Pluginsで、iOS用に追加したファイルのIDを取得できない問題に対処するパッチ</a></li></ul><p>そのため、<code>@expo/cli</code>が使用する<code>@expo/config-plugins</code>と同じバージョンを<code>devDependencies</code>に追加して、<code>node_modules</code>配下の構成を以下のようにしました。</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">node_modules/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── @expo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── cli</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── config-plugins(6.0.1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── @react-native-firebase</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── app</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   │   ├── node_modules</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   │   │   │   ├── config-plugins(5.0.4)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>この対応により、パッチを適用するパスは常に<code>node_modules/@expo/config-plugins</code>になります。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jest-expoのアップグレード"><code>jest-expo</code>のアップグレード<a href="#jest-expoのアップグレード" class="hash-link" aria-label="jest-expoのアップグレード への直接リンク" title="jest-expoのアップグレード への直接リンク">​</a></h3><p>以前は、<code>expo-cli upgrade</code>を使用してExpo SDKのアップグレードを実施していました。しかし、<a href="https://blog.expo.dev/expo-sdk-48-ccb8302e231#b801" target="_blank" rel="noopener noreferrer">Expo SDK 48 - Upgrading your app</a>を確認すると、アップグレード手順が変更されていました。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Expo SDK 47へのアップグレード手順</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">expo-cli upgrade</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Expo SDK 48へのアップグレード手順</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> expo@^48.0.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">npx expo </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> --fix</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>上記コマンドを実行すると、<code>expo-cli upgrade</code>では自動更新されていた<code>jest-expo</code>が更新されませんでした。そのため、<code>jest-expo</code>に関しては手動で<code>^48.0.0</code>に更新しました。</p><p>なお、上記事象に関してはExpoのForumsに質問を投稿しています。</p><ul><li><a href="https://forums.expo.dev/t/why-is-jest-expo-not-updated-when-i-run-npx-expo-install-fix/70965" target="_blank" rel="noopener noreferrer">Why is jest-expo not updated when I run npx expo install –fix?</a></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="既存のパッチファイルの更新">既存のパッチファイルの更新<a href="#既存のパッチファイルの更新" class="hash-link" aria-label="既存のパッチファイルの更新 への直接リンク" title="既存のパッチファイルの更新 への直接リンク">​</a></h3><p>このアプリでは、<a href="https://github.com/ds300/patch-package" target="_blank" rel="noopener noreferrer">patch-package</a>を使用して、以下のライブラリにパッチファイルを適用していました。パッチ内容の詳細は、<a href="https://github.com/fintan-contents/mobile-app-crib-notes/blob/v2023.03/example-app/SantokuApp/patches/README.md" target="_blank" rel="noopener noreferrer">こちら</a>を参照してください。</p><ul><li>@expo/config-plugins</li><li>expo-splash-screen</li><li>react-native-elements</li></ul><p><code>@expo/config-plugins</code>の以下のコミットによる変更で、パッチファイルが適用できなくなっていたため、パッチファイルを再作成しました。
変更は改行の増減のみで、機能的な更新はありませんでした。</p><ul><li><a href="https://github.com/expo/expo/commit/ee2169270f3207bb4883a3bd9fe1221ef8b94dc2" target="_blank" rel="noopener noreferrer">[<!-- -->config-plugins<!-- -->]<!-- --> Rebuild JS files</a></li></ul><p><code>expo-splash-screen</code>は、Expo SDKのアップグレードに伴いバージョンが上がりました。しかし、適用していたパッチファイルはまだ必要な対応だったため、パッチファイルは削除せずに各ライブラリのバージョンに合わせてファイル名をリネームしました。</p><p>上記以外のライブラリに関しては、バージョンが変わらなかったため変更はありません。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expoが管理するライブラリに依存するライブラリの更新">Expoが管理するライブラリに依存するライブラリの更新<a href="#expoが管理するライブラリに依存するライブラリの更新" class="hash-link" aria-label="Expoが管理するライブラリに依存するライブラリの更新 への直接リンク" title="Expoが管理するライブラリに依存するライブラリの更新 への直接リンク">​</a></h3><p>Expoが管理するライブラリの更新に伴い、以下のライブラリのバージョンを更新しました。</p><table><thead><tr><th align="left">ライブラリ名</th><th align="left">更新前</th><th align="left">更新後</th></tr></thead><tbody><tr><td align="left"><code>@testing-library/react-native</code></td><td align="left"><code>18.1.0</code></td><td align="left"><code>18.2.0</code></td></tr><tr><td align="left"><code>@types/jest</code></td><td align="left"><code>&lt;27.0.0</code></td><td align="left"><code>&lt;30.0.0</code></td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expoの更新履歴の確認と対応">Expoの更新履歴の確認と対応<a href="#expoの更新履歴の確認と対応" class="hash-link" aria-label="Expoの更新履歴の確認と対応 への直接リンク" title="Expoの更新履歴の確認と対応 への直接リンク">​</a></h3><p>Expoの<a href="https://github.com/expo/expo/blob/main/CHANGELOG.md#4800--2023-02-09" target="_blank" rel="noopener noreferrer">CHANGELOG</a>を参照して、Expo SDKとExpoが管理するライブラリの更新内容を確認しました。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expo-randomからexpo-cryptoへの移行"><code>expo-random</code>から<code>expo-crypto</code>への移行<a href="#expo-randomからexpo-cryptoへの移行" class="hash-link" aria-label="expo-randomからexpo-cryptoへの移行 への直接リンク" title="expo-randomからexpo-cryptoへの移行 への直接リンク">​</a></h4><p><a href="#%E9%9D%9E%E6%8E%A8%E5%A5%A8%E3%81%A8%E3%81%AA%E3%82%8B%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA">Expo SDK 48の主な変更 - Expoがサポートするライブラリや機能 - 非推奨となるライブラリ</a>に記載した通り、<code>expo-random</code>は、<code>expo-crypto</code>に統合されました。
そのため、依存ライブラリから<code>expo-random</code>を削除しています。</p><p>また、<code>expo-random</code>を使用していた箇所は、<code>expo-crypto</code>を使用するように変更しています。</p><div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 修正前</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> Random </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;expo-random&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 修正後</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> Crypto </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;expo-crypto&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expo-keep-awakeのactivatekeepawakeが非推奨になったことへの対応"><code>expo-keep-awake</code>の<code>activateKeepAwake</code>が非推奨になったことへの対応<a href="#expo-keep-awakeのactivatekeepawakeが非推奨になったことへの対応" class="hash-link" aria-label="expo-keep-awakeのactivatekeepawakeが非推奨になったことへの対応 への直接リンク" title="expo-keep-awakeのactivatekeepawakeが非推奨になったことへの対応 への直接リンク">​</a></h4><p><a href="#expo-keep-awake">Expo SDK 48の主な変更 - Expoがサポートするライブラリや機能 - expo-keep-awake</a>に記載した通り、<code>expo-keep-awake</code>の<code>activateKeepAwake</code>が非推奨になりました。そのため、<code>activateKeepAwakeAsync</code>を使用するように変更しています。</p><div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 修正前</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">activateKeepAwake</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 修正後</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">activateKeepAwakeAsync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="react-native-communitydatetimepickerの一部の項目が非推奨になったことへの対応"><code>@react-native-community/datetimepicker</code>の一部の項目が非推奨になったことへの対応<a href="#react-native-communitydatetimepickerの一部の項目が非推奨になったことへの対応" class="hash-link" aria-label="react-native-communitydatetimepickerの一部の項目が非推奨になったことへの対応 への直接リンク" title="react-native-communitydatetimepickerの一部の項目が非推奨になったことへの対応 への直接リンク">​</a></h4><p><a href="#react-native-communitydatetimepicker">Expo SDK 48の主な変更 - Expoがサポートするライブラリや機能 - @react-native-community/datetimepicker</a>に記載した通り、<code>@react-native-community/datetimepicker</code>の一部の項目が非推奨になっています。</p><p>このアプリでは<code>neutralButtonLabel</code>を使用していたため、以下のように変更しています。</p><div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 修正前</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pickerItemsProps</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">neutralButtonLabel</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">m</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;消去&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 修正後</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pickerItemsProps</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">neutralButton</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">label</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">m</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;消去&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="react-nativeの更新履歴の確認と対応">React Nativeの更新履歴の確認と対応<a href="#react-nativeの更新履歴の確認と対応" class="hash-link" aria-label="React Nativeの更新履歴の確認と対応 への直接リンク" title="React Nativeの更新履歴の確認と対応 への直接リンク">​</a></h3><p>React Nativeの<a href="https://github.com/facebook/react-native/blob/main/CHANGELOG.md#v0716" target="_blank" rel="noopener noreferrer">CHANGELOG</a>を参照して、React Nativeの更新内容を確認しました。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="typesreact-nativeを依存ライブラリから削除"><code>@types/react-native</code>を依存ライブラリから削除<a href="#typesreact-nativeを依存ライブラリから削除" class="hash-link" aria-label="typesreact-nativeを依存ライブラリから削除 への直接リンク" title="typesreact-nativeを依存ライブラリから削除 への直接リンク">​</a></h4><p><a href="#react-native-0716-and-react-1820">Expo SDK 48の主な変更 - React Native 0.71.6 and React 18.2.0</a>に記載した通り、<code>react-native</code>に型定義が含まれるようになりました。
そのため、依存ライブラリから<code>@types/react-native</code>を削除しています。</p><p>上記対応をしたところ、<a href="https://github.com/fintan-contents/mobile-app-crib-notes/blob/v2023.03/example-app/SantokuApp/src/bases/ui/overlay/OverlayBackdrop.tsx#L3" target="_blank" rel="noopener noreferrer">OverlayBackdrop.tsx</a>で以下の型エラーが発生しました。</p><blockquote><p>TS2305: Module &#x27;&quot;react-native&quot;&#x27; has no exported member &#x27;Omit&#x27;</p></blockquote><p><code>Omit</code>を<code>typescript</code>からではなく、<code>react-native</code>からimportしていたためです。
これは、以下のように<code>react-native</code>からのimportを削除して、<code>typescript</code>で定義されている型定義を参照するように修正しました。</p><div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">OverlayBackdrop.tsx</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 修正前</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">Omit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> Pressable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PressableProps</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> StyleSheet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> View</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ViewProps</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;react-native&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 修正後</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">Pressable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PressableProps</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> StyleSheet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> View</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ViewProps</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;react-native&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expo-template-blank-typescriptの更新履歴の確認と対応">expo-template-blank-typescriptの更新履歴の確認と対応<a href="#expo-template-blank-typescriptの更新履歴の確認と対応" class="hash-link" aria-label="expo-template-blank-typescriptの更新履歴の確認と対応 への直接リンク" title="expo-template-blank-typescriptの更新履歴の確認と対応 への直接リンク">​</a></h3><p><a href="https://github.com/expo/expo/commits/sdk-48/templates/expo-template-blank-typescript" target="_blank" rel="noopener noreferrer">expo-template-blank-typescriptの更新履歴</a>を確認しました。</p><p><code>npm install expo@^48.0.0</code>、<code>npx expo install --fix</code>で更新される依存ライブラリのアップグレードが主な変更でした。そのため、このアプリで特別な対応は必要ありませんでした。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expo-template-bare-minimumの更新履歴の確認と対応">expo-template-bare-minimumの更新履歴の確認と対応<a href="#expo-template-bare-minimumの更新履歴の確認と対応" class="hash-link" aria-label="expo-template-bare-minimumの更新履歴の確認と対応 への直接リンク" title="expo-template-bare-minimumの更新履歴の確認と対応 への直接リンク">​</a></h3><p><a href="https://github.com/expo/expo/commits/sdk-48/templates/expo-template-bare-minimum" target="_blank" rel="noopener noreferrer">expo-template-bare-minimumの更新履歴</a>を確認しました。</p><p>このアプリでは<a href="/mobile-app-crib-notes/react-native/santoku/maintenance/enhance/config-plugins">Config Pluginsに対応</a>しているので、<code>expo-template-bare-minimum</code>の更新に伴う個別の対応は基本的に必要ありません。
ただし、以下の場合は個別に対応する必要があります。</p><ul><li>このアプリで作成しているConfig Pluginsによる変更と、<code>expo-template-bare-minimum</code>の更新に伴う変更が競合した場合</li><li><a href="/mobile-app-crib-notes/react-native/santoku/development/build-configuration#prebuild">Prebuild</a>時に生成されないファイル</li></ul><p>上記内容を観点に<code>expo-template-bare-minimum</code>の更新履歴を確認しました。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="buckconfigの削除とgitignoreの更新"><code>.buckconfig</code>の削除と<code>.gitignore</code>の更新<a href="#buckconfigの削除とgitignoreの更新" class="hash-link" aria-label="buckconfigの削除とgitignoreの更新 への直接リンク" title="buckconfigの削除とgitignoreの更新 への直接リンク">​</a></h4><p><code>expo-template-bare-minimum</code>の以下のコミットで、<code>.buckconfig</code>が削除され、<code>.gitignore</code>が更新されていました。</p><ul><li><a href="https://github.com/expo/expo/commit/84f418d73be6d8683992cefbe4fc26d1f40eaaa4" target="_blank" rel="noopener noreferrer">upgrade react-native 0.71</a></li></ul><p>このアプリで修正した<code>.gitignore</code>のdiffは以下になります。</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">.gitignore</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">local.properties</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">*.iml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">*.hprof</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">*.keystore</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">!debug.keystore</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"># node.js</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">#</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token plain">@@ -37,12 +39,6 @@ node_modules/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">npm-debug.log</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">yarn-error.log</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"># BUCK</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">buck-out/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">\.buckd/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">*.keystore</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">!debug.keystore</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"># Bundle artifacts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">*.jsbundle</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@@ -50,6 +46,9 @@ buck-out/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">/.bundle/vendor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">/ios/Pods/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"># Temporary files created by Metro to check the health of the file watcher</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">.metro-health-check*</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"># Expo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">.expo/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">web-build/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="javascriptのエンジンをhermesに変更">JavaScriptのエンジンをHermesに変更<a href="#javascriptのエンジンをhermesに変更" class="hash-link" aria-label="JavaScriptのエンジンをHermesに変更 への直接リンク" title="JavaScriptのエンジンをHermesに変更 への直接リンク">​</a></h3><p><a href="#javascript%E3%81%AE%E3%83%87%E3%83%95%E3%82%A9%E3%83%AB%E3%83%88%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3%E3%82%92hermes%E3%81%AB%E5%A4%89%E6%9B%B4">Expo SDK 48の主な変更 - JavaScriptのデフォルトエンジンをHermesに変更</a>に記載した通り、Expo SDK 48からは<code>Hermes</code>がデフォルトのJavaScriptエンジンになりました。</p><p>そのため、このアプリもJavaScriptのエンジンを<code>Hermes</code>に変更しています。</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">app.config.js</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 修正前</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token literal-property property">jsEngine</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;jsc&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 修正後</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token literal-property property">jsEngine</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;hermes&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>なお、デフォルトが<code>Hermes</code>なのであえて<code>jsEngine</code>を指定する必要はありません。このアプリでは使用しているJavaScriptエンジンを明示するために、<code>jsEngine</code>を設定しています。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="flatlistでデータが0件の場合にscrolltoendを実行するとエラーが発生する問題の対応"><code>FlatList</code>でデータが0件の場合に<code>scrollToEnd</code>を実行するとエラーが発生する問題の対応<a href="#flatlistでデータが0件の場合にscrolltoendを実行するとエラーが発生する問題の対応" class="hash-link" aria-label="flatlistでデータが0件の場合にscrolltoendを実行するとエラーが発生する問題の対応 への直接リンク" title="flatlistでデータが0件の場合にscrolltoendを実行するとエラーが発生する問題の対応 への直接リンク">​</a></h3><p><code>react-native</code>のアップグレードに伴い、FlatListでデータが0件の場合に<code>scrollToEnd</code>を実行すると以下のエラーが発生しました。</p><blockquote><p>ERROR  Invariant Violation: Tried to get frame for out of range index -1, js engine: hermes</p></blockquote><p>この問題に対するissueとPull Requestは以下になります。</p><ul><li><a href="https://github.com/facebook/react-native/issues/36066" target="_blank" rel="noopener noreferrer">scrollToEnd fails on empty FlatList jest</a></li><li><a href="https://github.com/facebook/react-native/pull/36067" target="_blank" rel="noopener noreferrer">fix: fix virtualizedList scrollToEnd for 0 items</a></li></ul><p>Pull Requestは既にクローズされ<code>main</code>ブランチにはマージされていますが、<code>react-native</code>の<code>0.71.6</code>には含まれていません。
そのため、<a href="https://github.com/ds300/patch-package" target="_blank" rel="noopener noreferrer">patch-package</a>を使用して、Pull Requestで対応されている内容を含んだパッチファイルを作成しました。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jestのアップグレード対応">Jestのアップグレード対応<a href="#jestのアップグレード対応" class="hash-link" aria-label="Jestのアップグレード対応 への直接リンク" title="Jestのアップグレード対応 への直接リンク">​</a></h3><p>Jestは26系から29系にアップグレードされ、メジャーバージョンが3つも上がりました。
デフォルトのテストランナーが<a href="https://github.com/jestjs/jest/tree/v26.6.3/packages/jest-jasmine2" target="_blank" rel="noopener noreferrer">jest-jasmine2</a>から<a href="https://github.com/jestjs/jest/tree/v29.5.0/packages/jest-circus" target="_blank" rel="noopener noreferrer">jest-circus</a>に変更されるなど、更新内容は多岐にわたります。</p><p>更新内容の詳細は以下を参照してください。</p><ul><li><a href="https://github.com/jestjs/jest/blob/main/CHANGELOG.md#2950" target="_blank" rel="noopener noreferrer">CHANGELOG</a></li></ul><p>このアプリでは、いくつかの自動テストが失敗するなど修正を必要とする箇所がありました。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jest__mocks__配下のモックファイルで実施しているbeforeeachでエラー"><code>jest/__mocks__</code>配下のモックファイルで実施している<code>beforeEach</code>でエラー<a href="#jest__mocks__配下のモックファイルで実施しているbeforeeachでエラー" class="hash-link" aria-label="jest__mocks__配下のモックファイルで実施しているbeforeeachでエラー への直接リンク" title="jest__mocks__配下のモックファイルで実施しているbeforeeachでエラー への直接リンク">​</a></h4><p>一部のテストを実行したところ以下のエラーが発生しました。<code>jest/__mocks__</code>配下のモックファイルで実行している<code>beforeEach</code>でエラーが発生しています。</p><blockquote><p>Error: Hooks cannot be defined inside tests. Hook of type &quot;beforeEach&quot; is nested within</p></blockquote><p><code>jest/__mocks__</code>配下のモックファイルは、モックしているライブラリなどが<code>import</code>、<code>require</code>されたときに読み込まれます。
このアプリの一部のテストでは、テスト対象のコンポーネントの内部で、条件によって<code>require</code>するライブラリを切り替えています。
それが原因でこのエラーが発生したと考えられます。</p><p>この問題は、Expo SDK 48のアップグレードの過程で検出した問題ですが、以前のバージョンでも期待通りの動作にはなっていませんでした（エラーログとして出力されていないだけでした）。</p><p>そのため、Expo SDK 48のアップグレードに関するPull Requestではなく、以下のPull Requestで別途対応しました。</p><ul><li><a href="https://github.com/ws-4020/mobile-app-crib-notes/pull/1125" target="_blank" rel="noopener noreferrer">🩹: Jestでテスト実施前のモッククリア方法を修正</a></li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="react-native-communitynetinfoを使用しているコンポーネントのテストでエラー"><code>@react-native-community/netinfo</code>を使用しているコンポーネントのテストでエラー<a href="#react-native-communitynetinfoを使用しているコンポーネントのテストでエラー" class="hash-link" aria-label="react-native-communitynetinfoを使用しているコンポーネントのテストでエラー への直接リンク" title="react-native-communitynetinfoを使用しているコンポーネントのテストでエラー への直接リンク">​</a></h4><p><code>@react-native-community/netinfo</code>を使用しているコンポーネントのテストで以下のエラーが発生しました。</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Cannot read properties of undefined (reading &#x27;isInternetReachable&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TypeError: Cannot read properties of undefined (reading &#x27;isInternetReachable&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">at InternetReachability.isInternetReachable [as update] (~/dev/src/github.com/ws-4020/mobile-app-crib-notes-expo-48/example-app/SantokuApp/node_modules/@react-native-community/netinfo/lib/commonjs/internal/internetReachability.ts:148:20)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">at State.update (~/dev/src/github.com/ws-4020/mobile-app-crib-notes-expo-48/example-app/SantokuApp/node_modules/@react-native-community/netinfo/lib/commonjs/internal/state.ts:74:32)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">at Generator.next (&lt;anonymous&gt;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">at asyncGeneratorStep (~/dev/src/github.com/ws-4020/mobile-app-crib-notes-expo-48/example-app/SantokuApp/node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:24)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">at _next (~/dev/src/github.com/ws-4020/mobile-app-crib-notes-expo-48/example-app/SantokuApp/node_modules/@babel/runtime/helpers/asyncToGenerator.js:22:9)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>対応としては<code>@react-native-community/netinfo</code>をモック化するJestのセットアップファイルを作成し、それを<code>jest.config.js</code>に設定しました。</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">jest/setup/netinfo.js</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports">mockRNCNetInfo</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@react-native-community/netinfo/jest/netinfo-mock.js&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">jest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">mock</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@react-native-community/netinfo&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> mockRNCNetInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">jest.config.js</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* ～省略～ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token literal-property property">setupFiles</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;&lt;rootDir&gt;/jest/setup/global.js&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;&lt;rootDir&gt;/jest/setup/netinfo.js&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// &lt;- 追加</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* ～省略～ */</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="doneコールバックを使用しているテストは非同期関数にできない">doneコールバックを使用しているテストは非同期関数にできない<a href="#doneコールバックを使用しているテストは非同期関数にできない" class="hash-link" aria-label="doneコールバックを使用しているテストは非同期関数にできない への直接リンク" title="doneコールバックを使用しているテストは非同期関数にできない への直接リンク">​</a></h4><p>Jest27以降では、<code>done</code>コールバックを使用しているテストで<code>async</code>/<code>await</code>を使用した非同期関数を使用できません。</p><div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// &lt;- doneコールバックを使用する場合は、asyncを付けられない</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">it</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;200ms経ってからスプラッシュスクリーンが閉じられること&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> done </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>一部のテストでは、<code>async</code>/<code>await</code>とdoneコールバックを併用していたため、そのテストでは<code>done</code>コールバックを使用しないように修正しました。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="fake-timersのデフォルトがmodernに変更">Fake Timersのデフォルトが<code>modern</code>に変更<a href="#fake-timersのデフォルトがmodernに変更" class="hash-link" aria-label="fake-timersのデフォルトがmodernに変更 への直接リンク" title="fake-timersのデフォルトがmodernに変更 への直接リンク">​</a></h4><p>Jest27以降では、Fake Timersのデフォルトが<code>modern</code>に変更されました。併せて、<code>jest.useFakeTimers</code>の引数に<code>modern</code>を設定できなくなりました。</p><p>そのため、<code>modern</code>なFake Timersを使用していた箇所を以下のように修正しています。</p><div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 修正前</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">jest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">useFakeTimers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;modern&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 修正後</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">jest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">useFakeTimers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>なお、<code>legacy</code>なFake Timersを使用したい場合は<code>jest.useFakeTimers({legacyFakeTimers: true})</code>のようにします。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jest実行時のオプションの変更">Jest実行時のオプションの変更<a href="#jest実行時のオプションの変更" class="hash-link" aria-label="Jest実行時のオプションの変更 への直接リンク" title="Jest実行時のオプションの変更 への直接リンク">​</a></h4><p><code>@mswjs/data</code>を使用しているコンポーネントのテストで以下のエラーが発生しました。</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Jest has detected the following 3 open handles potentially keeping Jest from exiting:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ●  MESSAGEPORT</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       9 |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      10 | export const initialDb = () =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &gt; 11 |   db = factory(models);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         |               ^</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      12 |   maxDb = factory(models);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      13 |   minDb = factory(models);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      14 | };</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      at Object.sync (node_modules/@mswjs/data/lib/extensions/sync.js:74:19)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      at factory (node_modules/@mswjs/data/lib/factory.js:50:12)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      at initialDb (src/fixtures/msw/db.ts:11:15)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      at Object.&lt;anonymous&gt; (src/apps/app/App.test.tsx:17:12)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:24)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      at _next (node_modules/@babel/runtime/helpers/asyncToGenerator.js:22:9)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      at node_modules/@babel/runtime/helpers/asyncToGenerator.js:27:7</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      at Object.&lt;anonymous&gt; (node_modules/@babel/runtime/helpers/asyncToGenerator.js:19:12)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>調査して見ると、<code>@mswjs/data</code>の内部で使用している<a href="https://developer.mozilla.org/ja/docs/Web/API/Broadcast_Channel_API" target="_blank" rel="noopener noreferrer">BroadcastChannel</a>がクローズされていないことが原因でした。
該当箇所は<a href="https://github.com/mswjs/data/blob/v0.11.2/src/extensions/sync.ts#L72" target="_blank" rel="noopener noreferrer">こちら</a>です。</p><p>これは、Jest実行時のオプションとして<a href="https://jestjs.io/ja/docs/cli#--detectopenhandles" target="_blank" rel="noopener noreferrer">--detectOpenHandles</a>を指定することで検出できる問題です。<code>--detectOpenHandles</code>は、クローズされていないリソースを検出してコンソールに出力するオプションです。</p><p>Jestのドキュメントには<code>--detectOpenHandles</code>の説明として以下も記載されています。</p><blockquote><p>このオプションには重大なパフォーマンスの低下があり、デバッグにのみ使用する必要があります。</p></blockquote><p>そのため、CI環境や<code>npm run test</code>実行時には<code>--detectOpenHandles</code>を指定しない方が良いという意見が挙がりました。また、モバイルアプリにおいては、以下の理由によりリソースのクローズ漏れがサーバサイド程クリティカルな問題にはならないという意見もありました。</p><ul><li>モバイルアプリは使用者の端末で動作するため、リソースのクローズ漏れによる影響がサーバサイドと比較して小さい</li><li>モバイルアプリは停止、または再起動が比較的頻繁に行われるので、リソースのクローズ漏れが長時間継続することは少ない</li></ul><p>上記理由により、このアプリでは<code>--detectOpenHandles</code>を指定しないことにしました。</p><p>また、Jestはリソースがクローズされていない場合にプロセスが終了しません。そのため、<a href="https://jestjs.io/ja/docs/cli#--forceexit" target="_blank" rel="noopener noreferrer">--forceExit</a>を指定して、Jestを強制終了するようにしています。</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">package.json</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* ～省略～ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;scripts&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* ～省略～ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;test&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;jest --runInBand --forceExit&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;test:coverage&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;jest --runInBand --forceExit --coverage&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;test:report&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;jest --runInBand --forceExit --reporters=default --reporters=jest-junit --coverage&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* ～省略～ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>なお、今回の検討をする原因となった<code>@mswjs/data</code>のクローズ漏れについては、<code>@mswjs/data</code>をプロダクションで使用する可能性がほとんどないことから、特に対応はしていません。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="npm-run-androidでアプリが起動しない問題の対応"><code>npm run android</code>でアプリが起動しない問題の対応<a href="#npm-run-androidでアプリが起動しない問題の対応" class="hash-link" aria-label="npm-run-androidでアプリが起動しない問題の対応 への直接リンク" title="npm-run-androidでアプリが起動しない問題の対応 への直接リンク">​</a></h3><p>Expo SDK 48にアップグレード後、<code>npm run android</code>を実行すると以下のエラーが発生してアプリが起動しませんでした。
AndroidのAPIレベルが33の場合に発生する問題のようです（APIレベルが32のエミュレータで確認したところ、問題なく起動できました）。</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">› Opening jp.fintan.mobile.SantokuApp.local/.MainActivity on Pixel_3a_API_33</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CommandError: Couldn&#x27;t open Android app with activity &quot;jp.fintan.mobile.SantokuApp.local/.MainActivity&quot; on device &quot;Pixel_3a_API_33&quot;.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The app might not be installed, try installing it with: npx expo run:android -d Pixel_3a_API_33</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Activity class {jp.fintan.mobile.SantokuApp.local/jp.fintan.mobile.SantokuApp.local.MainActivity} does not exist.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>アプリのビルドは成功し、エミュレータにはインストールされているので、このアプリでは以下の運用で回避することにしました。</p><ul><li>エミュレータにインストールされたアプリを手動で起動</li><li><code>npm start</code>を実行してMetroを起動</li></ul><p>なお、この問題は以下のissueでExpoに報告しています。</p><ul><li><a href="https://github.com/expo/expo/issues/22210" target="_blank" rel="noopener noreferrer">[<!-- -->Android13<!-- -->]<!-- --> Couldn&#x27;t open Android app with app created using expo-template-bare-minimum</a></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="手動管理しているライセンスの更新">手動管理しているライセンスの更新<a href="#手動管理しているライセンスの更新" class="hash-link" aria-label="手動管理しているライセンスの更新 への直接リンク" title="手動管理しているライセンスの更新 への直接リンク">​</a></h3><p>このアプリでは、使用しているライブラリのライセンス一覧を出力するスクリプトを用意しています。詳細は、<a href="https://github.com/fintan-contents/mobile-app-crib-notes/blob/v2023.03/example-app/SantokuApp/.script/README.md" target="_blank" rel="noopener noreferrer">こちら</a>を参照してください。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="managed-licensejsの更新">managed-license.jsの更新<a href="#managed-licensejsの更新" class="hash-link" aria-label="managed-license.jsの更新 への直接リンク" title="managed-license.jsの更新 への直接リンク">​</a></h4><p>ライセンス情報が不足しており補完したい、あるいは、開発時のみ使用するため除外したいライブラリとバージョンを<a href="https://github.com/fintan-contents/mobile-app-crib-notes/blob/v2023.03/example-app/SantokuApp/.script/managed-license.js" target="_blank" rel="noopener noreferrer">managed-license.js</a>で管理しています。</p><p>ライセンス情報が不足しているライブラリなどは、以下のコマンドを実行することで確認できます。</p><ul><li><code>node .script/check-licenses.js</code></li></ul><p>実行した結果、いくつかのライブラリのライセンス情報を更新する必要がありました。
また、JavaScriptのエンジンを<code>Hermes</code>に変えたことで、明示的に除外していたAndroid JSCのライセンス設定も不要になったので、<code>managed-license.js</code>から削除しました。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ライセンスの表記ゆれに対応">ライセンスの表記ゆれに対応<a href="#ライセンスの表記ゆれに対応" class="hash-link" aria-label="ライセンスの表記ゆれに対応 への直接リンク" title="ライセンスの表記ゆれに対応 への直接リンク">​</a></h4><p>このアプリでは、アプリに表示するライセンス名を<a href="https://spdx.org/licenses/" target="_blank" rel="noopener noreferrer">SPDX</a>に合わせています。</p><p>今回のExpo SDKアップグレードでは、一部のライセンスでSPDXに定義されていないライセンス名を使用しているライブラリがありました。
そのライセンス名（<code>BSD 3-Clause</code>）を<a href="https://github.com/fintan-contents/mobile-app-crib-notes/blob/v2023.03/example-app/SantokuApp/.script/list-dependencies.js" target="_blank" rel="noopener noreferrer">list-dependencies.js</a>に追加しています。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated"><b><time datetime="2023-06-26T03:11:11.000Z">2023年6月26日</time></b>に<!-- -->最終更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメントページ"><a class="pagination-nav__link pagination-nav__link--prev" href="/mobile-app-crib-notes/react-native/santoku/maintenance/enhance/expo-49-upgrade"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">Expo SDK 49アップグレード</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/mobile-app-crib-notes/react-native/santoku/maintenance/enhance/expo-47-upgrade"><div class="pagination-nav__sublabel">次へ</div><div class="pagination-nav__label">Expo SDK 47アップグレード</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#expo-sdk-48の主な変更" class="table-of-contents__link toc-highlight">Expo SDK 48の主な変更</a><ul><li><a href="#react-native-0716-and-react-1820" class="table-of-contents__link toc-highlight">React Native 0.71.6 and React 18.2.0</a></li><li><a href="#javascriptのデフォルトエンジンをhermesに変更" class="table-of-contents__link toc-highlight">JavaScriptのデフォルトエンジンをHermesに変更</a></li><li><a href="#全てのexpoモジュールでapiレベルに33を設定" class="table-of-contents__link toc-highlight">全てのExpoモジュールでAPIレベルに33を設定</a></li><li><a href="#expo-goでrtl言語のサポート" class="table-of-contents__link toc-highlight">Expo GoでRTL言語のサポート</a></li><li><a href="#new-architecturefabricのサポート" class="table-of-contents__link toc-highlight">New Architecture/Fabricのサポート</a></li><li><a href="#expoがサポートするライブラリや機能" class="table-of-contents__link toc-highlight">Expoがサポートするライブラリや機能</a></li><li><a href="#expo-sdk-45のサポート終了" class="table-of-contents__link toc-highlight">Expo SDK 45のサポート終了</a></li></ul></li><li><a href="#このアプリで実施したアップグレードの手順" class="table-of-contents__link toc-highlight">このアプリで実施したアップグレードの手順</a><ul><li><a href="#expoconfig-pluginsをdevdependenciesに追加" class="table-of-contents__link toc-highlight"><code>@expo/config-plugins</code>を<code>devDependencies</code>に追加</a></li><li><a href="#jest-expoのアップグレード" class="table-of-contents__link toc-highlight"><code>jest-expo</code>のアップグレード</a></li><li><a href="#既存のパッチファイルの更新" class="table-of-contents__link toc-highlight">既存のパッチファイルの更新</a></li><li><a href="#expoが管理するライブラリに依存するライブラリの更新" class="table-of-contents__link toc-highlight">Expoが管理するライブラリに依存するライブラリの更新</a></li><li><a href="#expoの更新履歴の確認と対応" class="table-of-contents__link toc-highlight">Expoの更新履歴の確認と対応</a></li><li><a href="#react-nativeの更新履歴の確認と対応" class="table-of-contents__link toc-highlight">React Nativeの更新履歴の確認と対応</a></li><li><a href="#expo-template-blank-typescriptの更新履歴の確認と対応" class="table-of-contents__link toc-highlight">expo-template-blank-typescriptの更新履歴の確認と対応</a></li><li><a href="#expo-template-bare-minimumの更新履歴の確認と対応" class="table-of-contents__link toc-highlight">expo-template-bare-minimumの更新履歴の確認と対応</a></li><li><a href="#javascriptのエンジンをhermesに変更" class="table-of-contents__link toc-highlight">JavaScriptのエンジンをHermesに変更</a></li><li><a href="#flatlistでデータが0件の場合にscrolltoendを実行するとエラーが発生する問題の対応" class="table-of-contents__link toc-highlight"><code>FlatList</code>でデータが0件の場合に<code>scrollToEnd</code>を実行するとエラーが発生する問題の対応</a></li><li><a href="#jestのアップグレード対応" class="table-of-contents__link toc-highlight">Jestのアップグレード対応</a></li><li><a href="#npm-run-androidでアプリが起動しない問題の対応" class="table-of-contents__link toc-highlight"><code>npm run android</code>でアプリが起動しない問題の対応</a></li><li><a href="#手動管理しているライセンスの更新" class="table-of-contents__link toc-highlight">手動管理しているライセンスの更新</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contents</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/mobile-app-crib-notes/reference">Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">React Native</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/mobile-app-crib-notes/react-native/learn">Learn</a></li><li class="footer__item"><a class="footer__link-item" href="/mobile-app-crib-notes/react-native/santoku">Example App</a></li><li class="footer__item"><a class="footer__link-item" href="/mobile-app-crib-notes/react-native/common-pitfalls">Pitfalls</a></li></ul></div><div class="col footer__col"><div class="footer__title">Related Work</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://fintan.jp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Fintan<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://fintan.jp/?p=5952" target="_blank" rel="noopener noreferrer" class="footer__link-item">SPA + REST API構成のサービス開発リファレンス<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://fintan.jp/blog-tag/react-native" target="_blank" rel="noopener noreferrer" class="footer__link-item">Fintan » React Native<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><div class="no-content">
<div class="copyright">
  ドキュメントは、<a rel="license" href="https://fintan.jp/?page_id=201" target="_blank">Fintan コンテンツ 使用許諾条項</a>の下に提供されており、コードサンプルは<a rel="license" href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank">Apache 2.0 License</a>の下に提供されています。
</div>
<div class="supplementary">
  <a href="/mobile-app-crib-notes/terms-of-use/" class="footer__link-item">当サイトのご利用にあたって</a>
  <a href="/mobile-app-crib-notes/trademark/" class="footer__link-item">商標について</a>
</div>
</div>
</div></div></div></footer></div>
<script src="/mobile-app-crib-notes/assets/js/runtime~main.ad6d8a75.js"></script>
<script src="/mobile-app-crib-notes/assets/js/main.ab2052db.js"></script>
</body>
</html>